{"ast":null,"code":"import _regeneratorRuntime from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport moment from \"moment\";\nimport MessageEnum, { getName } from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\"; // Customizable Area Start\n// import { imgPasswordInVisible, imgPasswordVisible } from \"../assets\";\n// Customizable Area End\n\nexport var configJSON = require(\"./config\");\n\nvar SingleOrdersController = /*#__PURE__*/function (_BlockComponent) {\n  _inherits(SingleOrdersController, _BlockComponent);\n\n  var _super = _createSuper(SingleOrdersController);\n\n  // Customizable Area Start\n  // Customizable Area End\n  function SingleOrdersController(props) {\n    var _this;\n\n    _classCallCheck(this, SingleOrdersController);\n\n    _this = _super.call(this, props);\n    _this.apiEmailLoginCallId = \"\";\n    _this.validationApiCallId = \"\";\n    _this.fetchTrackingDetailsCallId = \"\";\n    _this.emailReg = void 0;\n    _this.labelTitle = \"\";\n\n    _this.getLocalDate = function (data) {\n      var date = data.date,\n          toFormat = data.toFormat;\n      var m = moment.utc(date).local().subtract('minutes', 5).utcOffset(+4).format(toFormat);\n      return m;\n    };\n\n    _this.receive = _this.receive.bind(_assertThisInitialized(_this)); // Customizable Area Start\n\n    _this.subScribedMessages = [getName(MessageEnum.CountryCodeMessage), getName(MessageEnum.RestAPIResponceMessage), getName(MessageEnum.ReciveUserCredentials)];\n    _this.state = {\n      ShowCOModal: false,\n      ShowPRModal: false,\n      shippingAddress: undefined,\n      trackingDetails: [],\n      loader: true\n    };\n    _this.emailReg = new RegExp(\"\");\n    _this.labelTitle = configJSON.labelTitle; // Customizable Area End\n\n    runEngine.attachBuildingBlock(_assertThisInitialized(_this), _this.subScribedMessages);\n    return _this;\n  }\n\n  _createClass(SingleOrdersController, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$props, _this$props$location;\n\n        var _this$props2, _this$props2$location, _this$props$location$, order;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.send(new Message(getName(MessageEnum.RequestUserCredentials)));\n\n                if ((_this$props = this.props) === null || _this$props === void 0 ? void 0 : (_this$props$location = _this$props.location) === null || _this$props$location === void 0 ? void 0 : _this$props$location.state) {\n                  _this$props$location$ = (_this$props2 = this.props) === null || _this$props2 === void 0 ? void 0 : (_this$props2$location = _this$props2.location) === null || _this$props2$location === void 0 ? void 0 : _this$props2$location.state, order = _this$props$location$.order;\n\n                  if (order) {\n                    this.setState({\n                      shippingAddress: order.delivery_addresses[0]\n                    });\n                  }\n\n                  this.fetchTrackingDetails();\n                } else {\n                  this.props.history.push(\"/profile-sec\");\n                } // Customizable Area Start\n                // Customizable Area End\n\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }() // Customizable Area Start\n    // Customizable Area End\n\n  }, {\n    key: \"receive\",\n    value: function () {\n      var _receive = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(from, message) {\n        var apiRequestCallId, resposeJSON, errorMessage;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                // Customizable Area Start\n                if (message.id === getName(MessageEnum.RestAPIResponceMessage)) {\n                  apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n                  resposeJSON = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n                  errorMessage = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n\n                  if (this.fetchTrackingDetailsCallId === apiRequestCallId) {\n                    this.setState({\n                      trackingDetails: resposeJSON === null || resposeJSON === void 0 ? void 0 : resposeJSON.data,\n                      loader: false\n                    });\n                  }\n                } // Customizable Area End\n\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function receive(_x, _x2) {\n        return _receive.apply(this, arguments);\n      }\n\n      return receive;\n    }()\n  }, {\n    key: \"fetchTrackingDetails\",\n    value: function fetchTrackingDetails() {\n      var _this$props3, _this$props3$location;\n\n      if ((_this$props3 = this.props) === null || _this$props3 === void 0 ? void 0 : (_this$props3$location = _this$props3.location) === null || _this$props3$location === void 0 ? void 0 : _this$props3$location.state) {\n        var _this$props4, _this$props4$location, _this$props4$location2, _this$props4$location3;\n\n        var token = localStorage.getItem(\"token\");\n        var headers = {\n          token: token,\n          \"Content-Type\": \"application/json\"\n        };\n        var ProductID = (_this$props4 = this.props) === null || _this$props4 === void 0 ? void 0 : (_this$props4$location = _this$props4.location) === null || _this$props4$location === void 0 ? void 0 : (_this$props4$location2 = _this$props4$location.state) === null || _this$props4$location2 === void 0 ? void 0 : (_this$props4$location3 = _this$props4$location2.orderItem) === null || _this$props4$location3 === void 0 ? void 0 : _this$props4$location3.id;\n        var requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n        this.fetchTrackingDetailsCallId = requestMessage.messageId;\n        requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.trackingOrderDetailsAPIEndPoint + '?' + \"track=order_item&id=\".concat(ProductID));\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), headers);\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.apiGetMethod);\n        console.log(\"request\", requestMessage); // Sending Request to call API.\n\n        runEngine.sendMessage(requestMessage.id, requestMessage);\n      }\n    }\n  }, {\n    key: \"sendLoginFailMessage\",\n    value: function sendLoginFailMessage() {\n      var msg = new Message(getName(MessageEnum.LoginFaliureMessage));\n      this.send(msg);\n    } // useEffect(() => {\n    //   if (!orderItem) {\n    //     routeToProfile();\n    //   } else {\n    //     let localAddressIndex = order.delivery_addresses.findIndex(\n    //       (item) =>\n    //         item.address_for === \"shipping\" ||\n    //         item.address_for === \"billing and shipping\"\n    //     );\n    //     if (localAddressIndex >= 0) {\n    //       setShippingAddress(order.delivery_addresses[localAddressIndex]);\n    //     }\n    //   }\n    //   console.log(\"tracking details :\", trackingDetails?.tracking_detail, orderItem);\n    // }, [props])\n\n  }, {\n    key: \"routeToProfile\",\n    value: function routeToProfile() {\n      var path = \"/profilebio\";\n      this.props.history.push({\n        pathname: path,\n        state: {\n          activeTab: \"myorder\"\n        }\n      });\n    }\n  }, {\n    key: \"getImageUrl\",\n    value: function getImageUrl() {\n      var _orderItem$attributes, _orderItem$attributes2, _orderItem$attributes3, _orderItem$attributes4, _orderItem$attributes5, _orderItem$attributes6;\n\n      var orderItem = this.props.location.state.orderItem;\n\n      if ((orderItem === null || orderItem === void 0 ? void 0 : (_orderItem$attributes = orderItem.attributes) === null || _orderItem$attributes === void 0 ? void 0 : (_orderItem$attributes2 = _orderItem$attributes.product_images) === null || _orderItem$attributes2 === void 0 ? void 0 : (_orderItem$attributes3 = _orderItem$attributes2.data) === null || _orderItem$attributes3 === void 0 ? void 0 : _orderItem$attributes3.length) && (orderItem === null || orderItem === void 0 ? void 0 : (_orderItem$attributes4 = orderItem.attributes) === null || _orderItem$attributes4 === void 0 ? void 0 : (_orderItem$attributes5 = _orderItem$attributes4.product_images) === null || _orderItem$attributes5 === void 0 ? void 0 : (_orderItem$attributes6 = _orderItem$attributes5.data) === null || _orderItem$attributes6 === void 0 ? void 0 : _orderItem$attributes6.length) > 0) {\n        var _orderItem$attributes7, _orderItem$attributes8;\n\n        return orderItem === null || orderItem === void 0 ? void 0 : (_orderItem$attributes7 = orderItem.attributes) === null || _orderItem$attributes7 === void 0 ? void 0 : (_orderItem$attributes8 = _orderItem$attributes7.product_images) === null || _orderItem$attributes8 === void 0 ? void 0 : _orderItem$attributes8.data[0].attributes.url;\n      }\n    }\n  }, {\n    key: \"getAddressString\",\n    value: function getAddressString() {\n      var shippingAddress = this.state.shippingAddress;\n\n      if (shippingAddress) {\n        return \"\".concat(shippingAddress.address, \", \").concat(shippingAddress.address_line_2, \", \").concat(shippingAddress.city, \", \").concat(shippingAddress.state, \", \").concat(shippingAddress.zip_code);\n      }\n\n      return \" 503 Branson Turnpike Suite 127, Lawrenceport, Florida 112202\";\n    }\n  }]);\n\n  return SingleOrdersController;\n}(BlockComponent);\n\nexport { SingleOrdersController as default };","map":{"version":3,"sources":["/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/packages/blocks/orderdetailview/src/OrderDetailsController.web.tsx"],"names":["Message","BlockComponent","moment","MessageEnum","getName","runEngine","configJSON","require","SingleOrdersController","props","apiEmailLoginCallId","validationApiCallId","fetchTrackingDetailsCallId","emailReg","labelTitle","getLocalDate","data","date","toFormat","m","utc","local","subtract","utcOffset","format","receive","bind","subScribedMessages","CountryCodeMessage","RestAPIResponceMessage","ReciveUserCredentials","state","ShowCOModal","ShowPRModal","shippingAddress","undefined","trackingDetails","loader","RegExp","attachBuildingBlock","send","RequestUserCredentials","location","order","setState","delivery_addresses","fetchTrackingDetails","history","push","from","message","id","apiRequestCallId","getData","RestAPIResponceDataMessage","resposeJSON","RestAPIResponceSuccessMessage","errorMessage","RestAPIResponceErrorMessage","token","localStorage","getItem","headers","ProductID","orderItem","requestMessage","RestAPIRequestMessage","messageId","addData","RestAPIResponceEndPointMessage","trackingOrderDetailsAPIEndPoint","RestAPIRequestHeaderMessage","RestAPIRequestMethodMessage","apiGetMethod","console","log","sendMessage","msg","LoginFaliureMessage","path","pathname","activeTab","attributes","product_images","length","url","address","address_line_2","city","zip_code"],"mappings":"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","sourcesContent":["import { IBlock } from \"../../../framework/src/IBlock\";\nimport { Message } from \"../../../framework/src/Message\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport MessageEnum, {\n  getName\n} from \"../../../framework/src/Messages/MessageEnum\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\n\n// Customizable Area Start\n// import { imgPasswordInVisible, imgPasswordVisible } from \"../assets\";\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\n\nexport interface Props {\n  navigation: any;\n  id: string;\n  history: any;\n  order: any;\n  orderItem: any;\n  // trackingDetails: any;\n  refetchData: any;\n  location: any;\n\n  // Customizable Area Start\n  // Customizable Area End\n}\n\ninterface S {\n  // Customizable Area Start\n  ShowCOModal: boolean;\n  ShowPRModal: boolean;\n  shippingAddress: any;\n  trackingDetails: any;\n  loader: boolean;\n  // Customizable Area End\n}\n\ninterface SS {\n  // Customizable Area Start\n  id: any;\n  // Customizable Area End\n}\n\nexport default class SingleOrdersController extends BlockComponent<\n  Props,\n  S,\n  SS\n  > {\n\n  // Customizable Area Start\n  apiEmailLoginCallId: string = \"\";\n  validationApiCallId: string = \"\";\n  fetchTrackingDetailsCallId: string = \"\";\n\n  emailReg: RegExp;\n  labelTitle: string = \"\";\n  // Customizable Area End\n\n  constructor(props: Props) {\n\n    super(props);\n    this.receive = this.receive.bind(this);\n\n    // Customizable Area Start\n    this.subScribedMessages = [\n      getName(MessageEnum.CountryCodeMessage),\n      getName(MessageEnum.RestAPIResponceMessage),\n      getName(MessageEnum.ReciveUserCredentials)\n    ]\n\n    this.state = {\n      ShowCOModal: false,\n      ShowPRModal: false,\n      shippingAddress: undefined,\n      trackingDetails: [],\n      loader: true,\n    };\n\n    this.emailReg = new RegExp(\"\");\n    this.labelTitle = configJSON.labelTitle;\n    // Customizable Area End\n\n    runEngine.attachBuildingBlock(this as IBlock, this.subScribedMessages);\n\n  }\n\n  async componentDidMount() {\n    this.send(new Message(getName(MessageEnum.RequestUserCredentials)));\n    if (this.props?.location?.state) {\n      const { order } = this.props?.location?.state;\n      if (order) {\n        this.setState({ shippingAddress: order.delivery_addresses[0] })\n      }\n      this.fetchTrackingDetails();\n    } else {\n      this.props.history.push(\"/profile-sec\");\n    }\n    // Customizable Area Start\n    // Customizable Area End\n  }\n\n  // Customizable Area Start\n\n\n  // Customizable Area End\n\n  async receive(from: string, message: Message) {\n\n    // Customizable Area Start\n    if (message.id === getName(MessageEnum.RestAPIResponceMessage)) {\n      const apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n      const resposeJSON = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n      const errorMessage = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n      if (this.fetchTrackingDetailsCallId === apiRequestCallId) {\n        this.setState({ trackingDetails: resposeJSON?.data, loader: false });\n      }\n    }\n    // Customizable Area End\n  }\n\n  fetchTrackingDetails() {\n    if (this.props?.location?.state) {\n      const token = localStorage.getItem(\"token\");\n      const headers = {\n        token,\n        \"Content-Type\": \"application/json\"\n      }\n      const ProductID = this.props?.location?.state?.orderItem?.id;\n      const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      this.fetchTrackingDetailsCallId = requestMessage.messageId;\n\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.trackingOrderDetailsAPIEndPoint + '?' + `track=order_item&id=${ProductID}`);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), headers);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.apiGetMethod);\n      console.log(\"request\", requestMessage);\n\n      // Sending Request to call API.\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n    }\n  }\n\n  sendLoginFailMessage() {\n    const msg: Message = new Message(getName(MessageEnum.LoginFaliureMessage));\n    this.send(msg);\n  }\n\n  // useEffect(() => {\n  //   if (!orderItem) {\n  //     routeToProfile();\n  //   } else {\n  //     let localAddressIndex = order.delivery_addresses.findIndex(\n  //       (item) =>\n  //         item.address_for === \"shipping\" ||\n  //         item.address_for === \"billing and shipping\"\n  //     );\n  //     if (localAddressIndex >= 0) {\n  //       setShippingAddress(order.delivery_addresses[localAddressIndex]);\n  //     }\n  //   }\n  //   console.log(\"tracking details :\", trackingDetails?.tracking_detail, orderItem);\n  // }, [props])\n\n  routeToProfile() {\n    let path = \"/profilebio\";\n    this.props.history.push({\n      pathname: path,\n      state: {activeTab: \"myorder\"}\n    });\n  };\n\n  getImageUrl() {\n    const { orderItem } = this.props.location.state;\n    if (orderItem?.attributes?.product_images?.data?.length && orderItem?.attributes?.product_images?.data?.length > 0) {\n      return orderItem?.attributes?.product_images?.data[0].attributes.url\n    }\n  }\n\n  getAddressString() {\n    const { shippingAddress } = this.state;\n    if (shippingAddress) {\n      return `${shippingAddress.address}, ${shippingAddress.address_line_2}, ${shippingAddress.city}, ${shippingAddress.state}, ${shippingAddress.zip_code}`\n    }\n    return \" 503 Branson Turnpike Suite 127, Lawrenceport, Florida 112202\"\n  }\n\n  getLocalDate = (data: any) => {\n    const { date, toFormat } = data;\n    let m =\n      moment.utc(date)\n        .local().subtract('minutes', 5).utcOffset(+4)\n        .format(toFormat);\n    return m;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}