{"ast":null,"code":"import _regeneratorRuntime from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\nimport { Message } from \"../../../framework/src/Message\";\nimport MessageEnum, { getName } from \"../../../framework/src/Messages/MessageEnum\";\nimport { uuid } from 'uuidv4'; // Customizable Area Start\n// Customizable Area End\n\nexport var configJSON = require(\"./config\");\n\n// Customizable Area Start\n// Customizable Area End\nvar ForgotPasswordController = /*#__PURE__*/function (_BlockComponent) {\n  _inherits(ForgotPasswordController, _BlockComponent);\n\n  var _super = _createSuper(ForgotPasswordController);\n\n  // Customizable Area Start\n  // Customizable Area End\n  function ForgotPasswordController(props) {\n    var _this;\n\n    _classCallCheck(this, ForgotPasswordController);\n\n    _this = _super.call(this, props);\n    _this.validationAPICallId = void 0;\n    _this.guestLoginApiCallId = void 0;\n    _this.resetOTPApiCallId = void 0;\n    _this.confirmEmailAPiCallID = void 0;\n\n    _this.SendOtpBtn = function (e) {\n      e.preventDefault();\n      var res;\n      var _this$state = _this.state,\n          emailError = _this$state.emailError,\n          otp = _this$state.otp,\n          email = _this$state.email;\n\n      if (emailError === 'success') {\n        if (otp == '') {\n          // setOtpError('empty');\n          _this.setState({\n            otpError: \"empty\"\n          });\n        } else {\n          var v = _this.isValidOTP(otp);\n\n          if (!v) {\n            // setOtpError('invalid');\n            _this.setState({\n              otpError: \"invalid\"\n            });\n          } else {\n            // setOtpError('');\n            _this.setState({\n              otpError: \"\"\n            });\n\n            _this.verifyOTP();\n          }\n        }\n      } else {\n        if (email == '') {\n          _this.setState({\n            emailError: \"empty\"\n          }); // setEmailError('empty');\n\n\n          return;\n        } else {\n          var d = _this.isValidEmail(email);\n\n          if (!d) {\n            // setNotRegister('');\n            _this.setState({\n              emailError: \"wrong\",\n              notRegister: \"\"\n            }); // setEmailError('wrong');\n\n          } else {\n            if (emailError != 'success') {\n              _this.emailConfirm();\n            }\n          }\n        }\n      }\n    };\n\n    _this.emailConfirm = function () {\n      var email = _this.state.email; // setShowSpinner(true);\n\n      _this.setState({\n        showSpinner: true\n      });\n\n      var data = {\n        data: {\n          type: \"email_account\",\n          process: \"reset_password\",\n          attributes: {\n            email: email\n          }\n        }\n      };\n      var requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      _this.resetOTPApiCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.sendOTPAPIEndPoint);\n      var headers = {\n        'Content-Type': 'application/json'\n      };\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(data));\n      return runEngine.sendMessage(requestMessage.id, requestMessage);\n    };\n\n    _this.handleEmail = function (e) {\n      // setEmail(e.target.value);\n      _this.setState({\n        email: e.target.value\n      });\n\n      if (e.target.value.length > 0) {\n        // setOtp('');\n        _this.setState({\n          otp: \"\"\n        });\n      }\n\n      if (_this.state.emailError != '') {\n        var check = _this.isValidEmail(e.target.value);\n\n        if (check) {\n          // setEmailError('');\n          _this.setState({\n            emailError: \"\"\n          });\n        } else {\n          _this.setState({\n            emailError: \"wrong\"\n          }); // setEmailError('wrong');\n\n        }\n      }\n    };\n\n    _this.handleOTP = function (e) {\n      // setOtp(e.target.value);\n      _this.setState({\n        otp: e.target.value\n      });\n\n      if (_this.state.otpError != '' || e.target.value.length > 5) {\n        var check = _this.isValidOTP(e.target.value); // console.log(check, \"check\");\n\n\n        if (check) {\n          // setOtpError('');\n          _this.setState({\n            otpError: \"\"\n          });\n        } else {\n          // setOtpError('invalid');\n          _this.setState({\n            otpError: \"invalid\"\n          });\n        }\n      }\n    };\n\n    _this.verifyOTP = function () {\n      var token = localStorage.getItem(\"token\"); // setShowSpinner(true);\n\n      _this.setState({\n        showSpinner: true\n      });\n\n      var data = {\n        token: token,\n        pin: _this.state.otp\n      };\n\n      _this.setState({\n        otpToken: token\n      });\n\n      var requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      _this.confirmEmailAPiCallID = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.verifyOTPAPIEndPoint);\n      var headers = {\n        'Content-Type': 'application/json'\n      };\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(data));\n      return runEngine.sendMessage(requestMessage.id, requestMessage);\n    };\n\n    _this.guestUserHandler = function () {\n      _this.setState({\n        loading: true\n      });\n\n      var guestUserId = localStorage.getItem('guestUUID');\n      var generateID;\n\n      if (guestUserId) {\n        generateID = guestUserId;\n      } else {\n        generateID = uuid();\n        localStorage.setItem('guestUUID', generateID);\n      }\n\n      var headers = {\n        'Content-Type': 'application/json'\n      };\n      var requestBody = {\n        \"data\": {\n          \"type\": \"guest_account\",\n          \"attributes\": {\n            \"uuid\": generateID\n          }\n        }\n      };\n      var requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n      _this.guestLoginApiCallId = requestMessage.messageId;\n      requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.guestLoginAPIEndPoint);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), headers);\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(requestBody));\n      requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n      runEngine.sendMessage(requestMessage.id, requestMessage);\n    };\n\n    _this.subScribedMessages = [// Customizable Area Start\n    getName(MessageEnum.RestAPIResponceMessage), getName(MessageEnum.NavigationPayLoadMessage), getName(MessageEnum.CountryCodeMessage), getName(MessageEnum.ReciveUserCredentials) // Customizable Area End\n    ]; // @ts-ignore\n\n    _this.timer = 0;\n    _this.receive = _this.receive.bind(_assertThisInitialized(_this));\n    _this.startTimer = _this.startTimer.bind(_assertThisInitialized(_this));\n    _this.countDown = _this.countDown.bind(_assertThisInitialized(_this));\n    runEngine.attachBuildingBlock(_assertThisInitialized(_this), _this.subScribedMessages); // Customizable Area Start\n\n    _this.state = {\n      email: \"\",\n      emailError: \"\",\n      notRegister: \"\",\n      otp: \"\",\n      otpError: \"\",\n      passwordError: \"\",\n      otpToken: \"\",\n      showSpinner: false,\n      timer: 0,\n      seconds: 5\n    }; // Customizable Area End\n\n    return _this;\n  }\n\n  _createClass(ForgotPasswordController, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"secondsToTime\",\n    value: function secondsToTime(secs) {\n      var hours = Math.floor(secs / (60 * 60));\n      var divisor_for_minutes = secs % (60 * 60);\n      var minutes = Math.floor(divisor_for_minutes / 60);\n      var divisor_for_seconds = divisor_for_minutes % 60;\n      var seconds = Math.ceil(divisor_for_seconds);\n      var obj = {\n        // \"h\": hours,\n        // \"m\": minutes,\n        \"s\": seconds\n      };\n      return obj;\n    }\n  }, {\n    key: \"startTimer\",\n    value: function startTimer() {\n      // @ts-ignore\n      if (this.timer == 0 && this.state.timer > 0) {\n        // @ts-ignore\n        this.timer = setInterval(this.countDown, 1000);\n      }\n    }\n  }, {\n    key: \"countDown\",\n    value: function countDown() {\n      // @ts-ignore\n      var timer = this.state.timer - 1;\n      this.setState({\n        timer: timer\n      }); // Check if we're at zero.\n\n      if (timer == 0) {\n        // @ts-ignore\n        clearInterval(this.timer);\n      }\n    }\n  }, {\n    key: \"receive\",\n    value: function () {\n      var _receive = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(from, message) {\n        var apiRequestCallId, responseJson, errorResponse, _this$props, _this$props$history, meta, data, _responseJson$errors$, _responseJson$errors$2, _responseJson$meta;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                runEngine.debugLog('Message Received', message);\n\n                if (message.id === getName(MessageEnum.RestAPIResponceMessage)) {\n                  apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n                  responseJson = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n                  errorResponse = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n\n                  if (apiRequestCallId === this.guestLoginApiCallId) {\n                    if (responseJson && responseJson.data && responseJson.meta) {\n                      this.setState({\n                        // ...this.state,\n                        loading: false\n                      });\n                      localStorage.setItem('guestUserData', JSON.stringify(responseJson.data));\n                      localStorage.setItem('token', responseJson.meta.token); //@ts-ignore\n\n                      window.notify([{\n                        type: 'success',\n                        message: 'Welcome to Our Store !'\n                      }]); //@ts-ignore\n\n                      (_this$props = this.props) === null || _this$props === void 0 ? void 0 : (_this$props$history = _this$props.history) === null || _this$props$history === void 0 ? void 0 : _this$props$history.push('/home-page');\n                    }\n                  }\n\n                  if (apiRequestCallId === this.resetOTPApiCallId) {\n                    if (responseJson && responseJson.meta && responseJson.data) {\n                      this.setState({\n                        showSpinner: false\n                      });\n                      meta = responseJson.meta, data = responseJson.data;\n                      localStorage.setItem(\"token\", meta.token); // @ts-ignore\n\n                      this.timer = 0;\n                      this.setState({\n                        emailError: \"success\",\n                        notRegister: \"\",\n                        timer: 60,\n                        seconds: 60\n                      }, this.startTimer); // @ts-ignore\n\n                      window.notify([{\n                        message: \"OTP has been sent to you\",\n                        type: \"success\"\n                      }]);\n                    }\n\n                    if (responseJson && responseJson.errors && responseJson.errors.length > 0) {\n                      this.setState({\n                        showSpinner: false\n                      }); //@ts-ignore\n\n                      window.notify([{\n                        type: 'danger',\n                        message: ((_responseJson$errors$ = responseJson.errors[0]) === null || _responseJson$errors$ === void 0 ? void 0 : _responseJson$errors$.pin) || ((_responseJson$errors$2 = responseJson.errors[0]) === null || _responseJson$errors$2 === void 0 ? void 0 : _responseJson$errors$2.phone_number) || 'something went wrong!'\n                      }]);\n                    }\n                  }\n\n                  if (apiRequestCallId === this.confirmEmailAPiCallID) {\n                    if (responseJson) {\n                      this.setState({\n                        showSpinner: false\n                      }); // @ts-ignore\n\n                      window.notify([{\n                        message: responseJson === null || responseJson === void 0 ? void 0 : (_responseJson$meta = responseJson.meta) === null || _responseJson$meta === void 0 ? void 0 : _responseJson$meta.mesage,\n                        type: \"success\"\n                      }]);\n                    }\n\n                    if (responseJson && responseJson.errors && responseJson.errors.length > 0) {\n                      this.setState({\n                        showSpinner: false\n                      }); //@ts-ignore\n\n                      window.notify([{\n                        type: 'danger',\n                        message: responseJson.errors[0] || 'something went wrong!'\n                      }]);\n                    }\n                  }\n                } else {}\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function receive(_x, _x2) {\n        return _receive.apply(this, arguments);\n      }\n\n      return receive;\n    }()\n  }, {\n    key: \"isValidEmail\",\n    value: function isValidEmail(email) {\n      var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      return re.test(String(email).toLowerCase());\n    }\n  }, {\n    key: \"isValidOTP\",\n    value: function isValidOTP(otp) {\n      var re = /^\\d{5}$/gm.test(otp);\n      return re;\n    }\n  }]);\n\n  return ForgotPasswordController;\n}(BlockComponent);\n\nexport { ForgotPasswordController as default };","map":{"version":3,"sources":["/home/lp-greenapex/Desktop/new_BB_BLOCK/freemium87482-350702-react-native/src/packages/blocks/forgot-password/src/ForgotPasswordController.web.tsx"],"names":["BlockComponent","runEngine","Message","MessageEnum","getName","uuid","configJSON","require","ForgotPasswordController","props","validationAPICallId","guestLoginApiCallId","resetOTPApiCallId","confirmEmailAPiCallID","SendOtpBtn","e","preventDefault","res","state","emailError","otp","email","setState","otpError","v","isValidOTP","verifyOTP","d","isValidEmail","notRegister","emailConfirm","showSpinner","data","type","process","attributes","requestMessage","RestAPIRequestMessage","messageId","addData","RestAPIResponceEndPointMessage","sendOTPAPIEndPoint","headers","RestAPIRequestHeaderMessage","JSON","stringify","RestAPIRequestMethodMessage","httpPostMethod","RestAPIRequestBodyMessage","sendMessage","id","handleEmail","target","value","length","check","handleOTP","token","localStorage","getItem","pin","otpToken","verifyOTPAPIEndPoint","guestUserHandler","loading","guestUserId","generateID","setItem","requestBody","guestLoginAPIEndPoint","subScribedMessages","RestAPIResponceMessage","NavigationPayLoadMessage","CountryCodeMessage","ReciveUserCredentials","timer","receive","bind","startTimer","countDown","attachBuildingBlock","passwordError","seconds","secs","hours","Math","floor","divisor_for_minutes","minutes","divisor_for_seconds","ceil","obj","setInterval","clearInterval","from","message","debugLog","apiRequestCallId","getData","RestAPIResponceDataMessage","responseJson","RestAPIResponceSuccessMessage","errorResponse","RestAPIResponceErrorMessage","meta","window","notify","history","push","errors","phone_number","mesage","re","test","String","toLowerCase"],"mappings":"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","sourcesContent":["import { BlockComponent } from \"../../../framework/src/BlockComponent\";\nimport { IBlock } from \"../../../framework/src/IBlock\";\nimport { runEngine } from \"../../../framework/src/RunEngine\";\nimport { Message } from \"../../../framework/src/Message\";\nimport MessageEnum, { getName } from \"../../../framework/src/Messages/MessageEnum\";\nimport axios from \"axios\";\n// @ts-ignore\nimport map from \"lodash/map\";\n\nimport { uuid } from 'uuidv4';\n// Customizable Area Start\n// Customizable Area End\n\nexport const configJSON = require(\"./config\");\n\nexport interface Props {\n    navigation: any;\n    // Customizable Area Start\n    // Customizable Area End\n}\n\ninterface S {\n    // Customizable Area Start\n    email: string;\n    emailError: string;\n    notRegister: string;\n    otp: string;\n    otpError: string;\n    passwordError: string;\n    otpToken: any;\n    showSpinner: boolean,\n    timer: number\n    seconds: any;\n\n    loading?: boolean;\n    // Customizable Area End\n}\n\ninterface SS {\n    // Customizable Area Start\n    navigation: any;\n    // Customizable Area End\n}\n\n// Customizable Area Start\n\n// Customizable Area End\n\nexport default class ForgotPasswordController extends BlockComponent<\n    Props,\n    S,\n    SS\n> {\n    // Customizable Area Start\n    validationAPICallId: any;\n    guestLoginApiCallId: string;\n    resetOTPApiCallId: string;\n    confirmEmailAPiCallID: string;\n    // Customizable Area End\n\n    constructor(props: Props) {\n        super(props);\n        this.subScribedMessages = [\n            // Customizable Area Start\n            getName(MessageEnum.RestAPIResponceMessage),\n            getName(MessageEnum.NavigationPayLoadMessage),\n            getName(MessageEnum.CountryCodeMessage),\n            getName(MessageEnum.ReciveUserCredentials)\n            // Customizable Area End\n        ];\n        // @ts-ignore\n        this.timer = 0;\n        this.receive = this.receive.bind(this);\n        this.startTimer = this.startTimer.bind(this);\n        this.countDown = this.countDown.bind(this);\n        runEngine.attachBuildingBlock(this as IBlock, this.subScribedMessages);\n\n        // Customizable Area Start\n\n        this.state = {\n            email: \"\",\n            emailError: \"\",\n            notRegister: \"\",\n            otp: \"\",\n            otpError: \"\",\n            passwordError: \"\",\n            otpToken: \"\",\n            showSpinner: false,\n            timer: 0,\n            seconds: 5\n        };\n        // Customizable Area End\n    }\n\n    async componentDidMount() {\n    }\n\n    secondsToTime(secs: any) {\n        let hours = Math.floor(secs / (60 * 60));\n\n        let divisor_for_minutes = secs % (60 * 60);\n        let minutes = Math.floor(divisor_for_minutes / 60);\n\n        let divisor_for_seconds = divisor_for_minutes % 60;\n        let seconds = Math.ceil(divisor_for_seconds);\n\n        let obj = {\n            // \"h\": hours,\n            // \"m\": minutes,\n            \"s\": seconds\n        };\n        return obj;\n    }\n\n    startTimer() {\n        // @ts-ignore\n        if (this.timer == 0 && this.state.timer > 0) {\n            // @ts-ignore\n            this.timer = setInterval(this.countDown, 1000);\n        }\n    }\n\n    countDown() {\n        // @ts-ignore\n        let timer = this.state.timer - 1;\n        this.setState({\n            timer: timer,\n        });\n\n        // Check if we're at zero.\n        if (timer == 0) {\n            // @ts-ignore\n            clearInterval(this.timer);\n        }\n    }\n\n    async receive(from: string, message: Message) {\n        runEngine.debugLog('Message Received', message);\n        if (message.id === getName(MessageEnum.RestAPIResponceMessage)) {\n            let apiRequestCallId = message.getData(getName(MessageEnum.RestAPIResponceDataMessage));\n            var responseJson = message.getData(getName(MessageEnum.RestAPIResponceSuccessMessage));\n            var errorResponse = message.getData(getName(MessageEnum.RestAPIResponceErrorMessage));\n            if (apiRequestCallId === this.guestLoginApiCallId) {\n                if (responseJson && responseJson.data && responseJson.meta) {\n                    this.setState({\n                        // ...this.state,\n                        loading: false\n                    });\n                    localStorage.setItem('guestUserData', JSON.stringify(responseJson.data));\n                    localStorage.setItem('token', responseJson.meta.token);\n                    //@ts-ignore\n                    window.notify([{ type: 'success', message: 'Welcome to Our Store !' }])\n                    //@ts-ignore\n                    this.props?.history?.push('/home-page');\n                }\n            }\n            if (apiRequestCallId === this.resetOTPApiCallId) {\n                if (responseJson && responseJson.meta && responseJson.data) {\n                    this.setState({ showSpinner: false });\n                    const { meta, data } = responseJson;\n                    localStorage.setItem(\"token\", meta.token);\n                    // @ts-ignore\n                    this.timer = 0;\n                    this.setState({ emailError: \"success\", notRegister: \"\", timer: 60, seconds: 60 }, this.startTimer)\n                    // @ts-ignore\n                    window.notify([{ message: \"OTP has been sent to you\", type: \"success\" }])\n                }\n                if (responseJson && responseJson.errors && responseJson.errors.length > 0) {\n                    this.setState({ showSpinner: false });\n                    //@ts-ignore\n                    window.notify([{ type: 'danger', message: responseJson.errors[0]?.pin || responseJson.errors[0]?.phone_number || 'something went wrong!' }]);\n                }\n            }\n            if (apiRequestCallId === this.confirmEmailAPiCallID) {\n                if (responseJson) {\n                    this.setState({ showSpinner: false });\n                    // @ts-ignore\n                    window.notify([{ message: responseJson?.meta?.mesage, type: \"success\" }]);\n                }\n                if (responseJson && responseJson.errors && responseJson.errors.length > 0) {\n                    this.setState({ showSpinner: false })\n                    //@ts-ignore\n                    window.notify([{ type: 'danger', message: responseJson.errors[0] || 'something went wrong!' }])\n                }\n            }\n        }\n        else {\n\n        }\n    }\n\n    isValidEmail(email: string) {\n        const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return re.test(String(email).toLowerCase());\n    }\n\n    isValidOTP(otp: any) {\n        const re = /^\\d{5}$/gm.test(otp);\n        return re;\n    }\n\n    SendOtpBtn = (e: any) => {\n        e.preventDefault();\n        let res;\n        const { emailError, otp, email, } = this.state;\n\n        if (emailError === 'success') {\n            if (otp == '') {\n                // setOtpError('empty');\n                this.setState({ otpError: \"empty\" })\n            } else {\n                let v = this.isValidOTP(otp);\n                if (!v) {\n                    // setOtpError('invalid');\n                    this.setState({ otpError: \"invalid\" })\n                } else {\n                    // setOtpError('');\n                    this.setState({ otpError: \"\" })\n                    this.verifyOTP();\n                }\n            }\n        } else {\n            if (email == '') {\n                this.setState({ emailError: \"empty\" })\n                // setEmailError('empty');\n                return;\n            } else {\n                let d = this.isValidEmail(email);\n                if (!d) {\n                    // setNotRegister('');\n                    this.setState({ emailError: \"wrong\", notRegister: \"\" })\n                    // setEmailError('wrong');\n                } else {\n                    if (emailError != 'success') {\n                        this.emailConfirm();\n                    }\n                }\n            }\n        }\n    };\n\n    emailConfirm = () => {\n        const { email } = this.state;\n        // setShowSpinner(true);\n        this.setState({ showSpinner: true })\n        let data = {\n            data: {\n                type: \"email_account\",\n                process: \"reset_password\",\n                attributes: {\n                    email\n                }\n            }\n        }\n\n        const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n        this.resetOTPApiCallId = requestMessage.messageId;\n        requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.sendOTPAPIEndPoint);\n\n        const headers = {\n            'Content-Type': 'application/json'\n        }\n\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(data));\n\n        return runEngine.sendMessage(requestMessage.id, requestMessage);\n    };\n\n    handleEmail = (e: any) => {\n        // setEmail(e.target.value);\n        this.setState({ email: e.target.value })\n        if (e.target.value.length > 0) {\n            // setOtp('');\n            this.setState({ otp: \"\" })\n        }\n        if (this.state.emailError != '') {\n            let check = this.isValidEmail(e.target.value);\n            if (check) {\n                // setEmailError('');\n                this.setState({ emailError: \"\" });\n            } else {\n                this.setState({ emailError: \"wrong\" })\n                // setEmailError('wrong');\n            }\n        }\n\n    };\n\n    handleOTP = (e: any) => {\n        // setOtp(e.target.value);\n        this.setState({ otp: e.target.value })\n        if (this.state.otpError != '' || e.target.value.length > 5) {\n            let check = this.isValidOTP(e.target.value);\n            // console.log(check, \"check\");\n            if (check) {\n                // setOtpError('');\n                this.setState({ otpError: \"\" })\n            } else {\n                // setOtpError('invalid');\n                this.setState({ otpError: \"invalid\" })\n            }\n        }\n    };\n\n    verifyOTP = () => {\n        const token = localStorage.getItem(\"token\");\n        // setShowSpinner(true);\n        this.setState({ showSpinner: true });\n\n        const data = {\n            token,\n            pin: this.state.otp\n        }\n        this.setState({ otpToken: token })\n        const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n        this.confirmEmailAPiCallID = requestMessage.messageId;\n        requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.verifyOTPAPIEndPoint);\n\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), JSON.stringify(headers));\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(data));\n\n        return runEngine.sendMessage(requestMessage.id, requestMessage);\n    };\n    //Guest User\n    guestUserHandler = () => {\n        this.setState({\n            loading: true\n        })\n        const guestUserId = localStorage.getItem('guestUUID');\n        let generateID;\n        if (guestUserId) {\n            generateID = guestUserId;\n        } else {\n            generateID = uuid();\n            localStorage.setItem('guestUUID', generateID);\n        }\n\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n\n        const requestBody = {\n            \"data\": {\n                \"type\": \"guest_account\",\n                \"attributes\": {\n                    \"uuid\": generateID\n                }\n            }\n        };\n        const requestMessage = new Message(getName(MessageEnum.RestAPIRequestMessage));\n        this.guestLoginApiCallId = requestMessage.messageId;\n        requestMessage.addData(getName(MessageEnum.RestAPIResponceEndPointMessage), configJSON.guestLoginAPIEndPoint);\n\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestHeaderMessage), headers);\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestBodyMessage), JSON.stringify(requestBody));\n        requestMessage.addData(getName(MessageEnum.RestAPIRequestMethodMessage), configJSON.httpPostMethod);\n\n        runEngine.sendMessage(requestMessage.id, requestMessage);\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}